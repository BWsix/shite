(this.webpackJsonptester004_1=this.webpackJsonptester004_1||[]).push([[0],{104:function(t,e,n){},108:function(t,e,n){},110:function(t,e,n){},111:function(t,e,n){},112:function(t,e,n){},224:function(t,e,n){},225:function(t,e,n){},226:function(t,e,n){var c={"./dark.css":[229,3],"./light.css":[230,4]};function r(t){if(!n.o(c,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=c[t],r=e[0];return n.e(e[1]).then((function(){return n.t(r,7)}))}r.keys=function(){return Object.keys(c)},r.id=226,t.exports=r},227:function(t,e,n){"use strict";n.r(e);var c=n(2),r=n.n(c),o=n(96),s=n.n(o),i=(n(104),n(3)),a=n(26),u=n(8),l=n(6),d=(n(228),n(63),n(97)),j=n(21),b=n.n(j),f=n(28),O=function(){var t=Object(f.a)(b.a.mark((function t(){var e;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new l.a.auth.GoogleAuthProvider,t.next=3,Ot.signInWithRedirect(e);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),h=function(){var t=Object(f.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ot.signOut();case 2:window.location.reload();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=(n(108),n(27),n(1)),p=function(){return Object(m.jsxs)("div",{className:"Login",children:[Object(m.jsx)("h1",{className:"Login-title",children:"Shite."}),Object(m.jsx)("button",{className:"btn-thick btn-round",onClick:O,children:"\ud83d\udca9 Login with Google \ud83d\udca9"})]})},x=n(48),g=n.n(x),v=n(231),y=function(){return JSON.parse(localStorage.getItem("userInfo"))||(localStorage.setItem("userInfo",JSON.stringify({_:{name:"",avatar:""}})),{_:{name:"",avatar:""}})},w=function(t){var e=y();if(t in e)return{name:e[t].name,avatar:e[t].avatar}},C=function(t,e,n){y(),function(t,e,n){var c=JSON.parse(localStorage.getItem("userInfo"));c[t]={name:e,avatar:n},localStorage.setItem("userInfo",JSON.stringify(c))}(t,e,n)},S=function(t){C(t.uid,t.displayName,t.photoURL);var e=ft.collection("users").doc(t.uid);e.get().then((function(n){n.exists?e.update({name:t.displayName,avatar:t.photoURL}):e.set({name:t.displayName,avatar:t.photoURL,bio:"",cover:"",following:[t.uid],posts:[]})}))},N=function(t){return t.trim().replace(/[\r\n]/g,"n_n_")},I=(n(110),function(t){var e=t.image_str,n=t.setImage_str,r=t.title,o=t.title_cancel,s=Object(c.useRef)(null),i=function(t){return new Promise((function(e){g.a.imageFileResizer(t,650,750,"JPEG",100,0,(function(t){e(t)}),"base64")}))},a=function(){var t=Object(f.a)(b.a.mark((function t(e){var c,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=e.target.files[0],t.next=3,i(c);case 3:r=t.sent,n(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsx)("label",{htmlFor:"image_uploader",className:"Upload btn-thin btn-sharp",children:Object(m.jsx)("small",{children:e?"Choose another":r||"Add an Image"})}),Object(m.jsx)("input",{type:"file",ref:s,accept:"image/x-png, image/jpeg",id:"image_uploader",style:{display:"none"},onChange:function(t){t.target.value.length&&a(t)}}),e&&Object(m.jsx)("button",{className:"btn-thin btn-sharp btn-left",onClick:function(){n(""),s.current.value=""},children:Object(m.jsx)("small",{children:o||"Remove"})})]})}),k=(n(111),function(t){var e=t.content,n=t.setContent,r=t.rows,o=t.publishButton,s=t.placeholder,a=void 0===s?"What's on your mind, folk?":s,u=t.style,l=Object(c.useState)((function(){return 1})),d=Object(i.a)(l,2),j=d[0],b=d[1];return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("textarea",{value:e,rows:Math.max(j+1,r||3),className:"InputField",style:u,placeholder:o?"Enter: publish\nShift+Enter: new line":a,onChange:function(t){n(t.target.value),b(t.target.value.split("\n").length)},onKeyDown:function(t){o&&("Enter"!==t.key||t.shiftKey||t.preventDefault())},onKeyUp:function(t){o&&("Enter"!==t.key||t.shiftKey||o.current.click())}})})}),E=function(t){var e=t.content,n="";return"loading"===e?n="Loading...":"error"===e&&(n="Error."),Object(m.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"60px"},children:Object(m.jsxs)("span",{style:{textAlign:"center"},children:["\ud83d\udca9 ",n.length?n:e," \ud83d\udca9"]})})},A=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(c.useState)(""),r=Object(i.a)(n,2),o=r[0],s=r[1],a=Object(c.useState)("https://i.imgur.com/xicaprt.png"),u=Object(i.a)(a,2),l=u[0],d=u[1],j=Object(c.useState)(""),b=Object(i.a)(j,2),f=b[0],O=b[1],h=Object(c.useState)("https://i.imgur.com/PZxq3zy.png"),m=Object(i.a)(h,2),p=m[0],x=m[1],g=Object(c.useState)(!1),v=Object(i.a)(g,2),y=v[0],S=v[1];return Object(c.useEffect)((function(){var n=w(t);n?(s((function(t){return n.name})),d((function(t){return n.avatar}))):ft.collection("users").doc(t).get().then((function(e){if(!e.exists)return S(!0);s(e.get("name")),d(e.get("avatar")),C(t,e.get("name"),e.get("avatar"))})),e&&ft.collection("users").doc(t).get().then((function(t){if(!t.exists)return S(!0);O(t.get("bio")),x(t.get("cover")||"https://i.imgur.com/PZxq3zy.png")}))}),[t]),{name:o,avatar:l,bio:f,cover:p,error:y}},P=(n(112),function(t){var e=t.type,n=t.uid,c=t.redirect,r=t.withName,o=t.hover,s=A(n),i=s.name,u=s.avatar,l="small"===e?35:"large"===e?55:void 0,d=Object(m.jsx)("img",{src:u,alt:i,className:o?"UserIcon UserIcon-hover":"UserIcon",title:c?"go to "+i+"' page":void 0,style:{width:l,height:l}});return c&&(d=Object(m.jsx)(a.b,{to:"/user/".concat(n),children:d})),r&&(d=Object(m.jsxs)("div",{className:"UserIcon-withName",children:[d,Object(m.jsx)("div",{className:"UserIcon-Name",children:Object(m.jsx)("b",{children:i})})]})),d}),_=n(99),B=n.n(_),T=(n(224),function(t){var e=t.content,n=t.center,c=t.markdown;return Object(m.jsx)(m.Fragment,{children:c?Object(m.jsx)("div",{className:"ParseContent-url",children:Object(m.jsx)(B.a,{children:e.replaceAll("n_n_","\n\n&nbsp;")})}):e.split("n_n_").map((function(t){return Object(m.jsxs)("div",{className:"ParseContent-line ParseContent-url",style:n&&{display:"flex",justifyContent:"center"},children:[t.split(" ").map((function(t){return Object(m.jsx)("span",{className:"ParseContent-word",children:t.startsWith("https://")||t.startsWith("http://")?Object(m.jsx)("a",{href:t,children:t+String.fromCharCode(160)}):t+String.fromCharCode(160)},Object(v.a)())})),Object(m.jsx)("br",{})]},Object(v.a)())}))})}),F=(n(37),n(38),function(){var t=Object(c.useContext)(ht),e=Object(c.useState)(""),n=Object(i.a)(e,2),r=n[0],o=n[1],s=Object(c.useState)(""),a=Object(i.a)(s,2),u=a[0],d=a[1],j=Object(c.useState)(!1),O=Object(i.a)(j,2),h=O[0],p=O[1],x=function(t){return new Promise((function(e){g.a.imageFileResizer(t,650,750,"JPEG",100,0,(function(t){e(t)}),"base64")}))};return Object(m.jsxs)("div",{className:"Post-outer",style:{width:"100%",margin:"calc(1vh + 15px) 0",borderRadius:"10px"},onPaste:function(){var t=Object(f.a)(b.a.mark((function t(e){var n,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.clipboardData.files[0]){t.next=2;break}return t.abrupt("return");case 2:return n=e.clipboardData.files[0],t.next=5,x(n);case 5:c=t.sent,d(c);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),children:[Object(m.jsxs)("div",{style:{padding:"10px"},children:[Object(m.jsx)(P,{type:"large",uid:t.uid,withName:!0}),Object(m.jsxs)("div",{className:"Post-content",children:[Object(m.jsx)("div",{style:{marginBottom:"10px"},children:Object(m.jsx)(k,{content:r,setContent:o,rows:4})}),Object(m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(m.jsx)(I,{image_str:u,setImage_str:d}),Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsxs)("button",{className:"btn-thin btn-sharp ShiteCount-".concat(h?"trigger":"btn"),onClick:function(){return p((function(t){return!t}))},children:["markdown(",h?"o":"x",")"]}),Object(m.jsx)("button",{className:"btn-thin btn-sharp btn-left",onClick:function(){if(!r.trim().length&&!u)return o("");!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ft.collection("posts").add({content:N(e),author:t,createdAt:l.a.firestore.FieldValue.serverTimestamp(),image:n,shiters:[],comments:[],markdown:c}).then((function(e){ft.collection("activities").doc("posts").update({type:"add",postId:e.id,uuid:Object(v.a)()}),ft.collection("users").doc(t).update({posts:l.a.firestore.FieldValue.arrayUnion(e.id)})}))}(t.uid,r,u,h),o(""),d(""),p(!1)},children:"Publish"})]})]})]})]}),u&&Object(m.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(m.jsx)("img",{src:u,alt:"img",style:{maxWidth:"100%",height:"auto"}})})]})}),D=n(34),L=r.a.createContext({}),R=function(){var t=Object(c.useContext)(L).post;return Object(m.jsx)("div",{className:"Post-content",children:Object(m.jsx)(T,{content:t.content,markdown:t.markdown})})},M=function(){var t=Object(c.useContext)(ht),e=Object(c.useContext)(L).post,n=Object(c.useState)((function(){return e.shiters.includes(t.uid)})),r=Object(i.a)(n,2),o=r[0],s=r[1];return Object(m.jsxs)("button",{style:{height:"100%",width:"90%"},className:"ShiteCount-btn btn-sharp ".concat(o?"ShiteCount-trigger":""),onClick:function(){!function(t,e,n){var c=ft.collection("posts").doc(e);c.get().then((function(e){"shite"===n?c.update({shiters:l.a.firestore.FieldValue.arrayUnion(t)}):c.update({shiters:l.a.firestore.FieldValue.arrayRemove(t)})}))}(t.uid,e.postId,o?"unshite":"shite"),s((function(t){return!t}))},title:o?void 0:"give this post a shite!",children:["\ud83d\udca9 ",e.shiters.length-(e.shiters.includes(t.uid)?o?0:1:o?-1:0)]})},U=function(t){var e=t.createdAt;return Object(m.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",color:"gray"},children:[Object(m.jsxs)("span",{style:{display:"inline-block"},children:[e.toLocaleDateString(),", "]}),Object(m.jsx)("span",{style:{display:"inline-block"},children:e.toLocaleTimeString()})]})},J=function(t){var e=t.setToggleComments,n=t.commentCount;return Object(m.jsxs)("button",{style:{height:"100%",width:"90%"},className:"btn-sharp ".concat(n?"":"ShiteCount-btn"),onClick:function(){return e(!0)},children:["comments ",n]})},W=function(t){var e=t.setToggleComments,n=Object(c.useContext)(L).post;return Object(m.jsxs)("div",{className:"Post-stats",children:[Object(m.jsx)("div",{className:"ShiteCount",children:Object(m.jsx)(M,{})}),Object(m.jsx)("div",{children:Object(m.jsx)(J,{setToggleComments:e,commentCount:n.comments?n.comments.length:0})}),Object(m.jsx)("div",{className:"TimePosted-outer",children:Object(m.jsx)(U,{createdAt:n.createdAt})})]})},z=function(t,e){ft.collection("posts").doc(e).update({content:N(t)}).then((function(){l.a.firestore().collection("activities").doc("posts").update({type:"edit",postId:e,uuid:Object(v.a)()})}))},V=function(t){var e=t.toggleEdit,n=t.setToggleEdit,r=t.editedContent,o=Object(c.useContext)(ht),s=Object(c.useContext)(L).post;return e?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{className:"btn-thin btn-round",onClick:function(){return n(!1)},children:Object(m.jsx)("small",{children:"cancel"})}),Object(m.jsx)("button",{className:"btn-thin btn-round btn-left",onClick:function(){r.trim().length&&(z(r.trim(),s.postId),n(!1))},children:Object(m.jsx)("small",{children:"save"})})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{className:"btn-thin btn-round",onClick:function(){n(!0)},children:Object(m.jsx)("small",{children:"edit"})}),Object(m.jsx)("button",{className:"btn-thin btn-round btn-left",onClick:function(){var t,e;confirm("delete this post?")&&(t=s.postId,e=o.uid,ft.collection("posts").doc(t).get().then((function(n){n.get("comments").forEach((function(t){ft.collection("comments").doc(t).delete()})),ft.collection("posts").doc(t).delete(),ft.collection("users").doc(e).update({posts:l.a.firestore.FieldValue.arrayRemove(t)})})),ft.collection("activities").doc("posts").update({postId:t,type:"delete",uuid:Object(v.a)()}))},children:Object(m.jsx)("small",{children:"delete"})})]})},G=function(t){var e=t.editedContent,n=t.setEditedContent,c=t.markdown;return Object(m.jsxs)("div",{className:"Post-content",style:{marginBottom:"10px"},children:[c?"(markdown)":void 0,Object(m.jsx)(k,{content:e,setContent:n,rows:Math.max(e.split("\n").length+1,4)})]})},K=function(t){var e=t.postId,n=Object(c.useState)("share"),r=Object(i.a)(n,2),o=r[0],s=r[1];return Object(m.jsx)("button",{className:"btn-thin btn-round btn-left",title:"copy to clipboard",onClick:function(){navigator.clipboard.writeText(window.location.origin+"/post/"+e),s("copied!")},children:Object(m.jsx)("small",{children:o})})},Y=function(t){var e;try{return!!(e=t.match(/(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/user\/\S+|\/ytscreeningroom\?v=|\/sandalsResorts#\w\/\w\/.*\/))([^\\/&]{10,12})/))&&e[1]}catch(n){return!1}},q=function(t){var e=t.content;return Object(m.jsx)("div",{style:{width:"100%",aspectRatio:"16/9"},children:Object(m.jsx)("iframe",{width:"100%",height:"100%",src:"https://www.youtube.com/embed/".concat(Y(e)),title:"YouTube video player",frameBorder:"0",allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})},Z=(n(59),function(t){var e=t.cmt,n=t.commentSectionRef,r=t.atBottom,o=Object(c.useRef)(null),s=A(e.comment.author).name;if(e.is_new&&r){var i=n.current;i&&i.scrollTo(0,i.scrollHeight)}return Object(m.jsxs)("div",{ref:o,className:"Comment ".concat(e.is_new?"Comment-new":""),children:[Object(m.jsx)(P,{type:"small",uid:e.comment.author,redirect:!0,hover:!0}),Object(m.jsxs)("div",{className:"Comment-text",children:[Object(m.jsxs)("b",{className:"Comment-name",children:[s," "]}),Object(m.jsxs)("span",{className:"Comment-time",children:[e.comment.createdAt.toLocaleDateString()," ",e.comment.createdAt.toLocaleTimeString()]}),Object(m.jsx)(T,{content:e.comment.content})]})]})}),H=function(t){var e=t.postId,n=Object(c.useContext)(ht),r=Object(c.useState)(""),o=Object(i.a)(r,2),s=o[0],a=o[1],u=Object(c.useRef)(null);return Object(m.jsxs)("div",{className:"AddComment Comment",children:[Object(m.jsx)(P,{type:"small",uid:n.uid}),Object(m.jsxs)("div",{style:{width:"100%",paddingLeft:"10px"},children:[Object(m.jsx)("b",{children:n.displayName}),Object(m.jsx)("div",{style:{width:"100%"},children:Object(m.jsx)(k,{content:s,setContent:a,publishButton:u})}),Object(m.jsx)("div",{style:{width:"100%",display:"flex",flexDirection:"row-reverse",marginTop:"10px"},children:Object(m.jsx)("button",{style:{display:"none"},ref:u,onClick:function(){if(!s.trim().length)return a("");!function(t,e,n){ft.collection("comments").add({postId:n,content:N(t),author:e,createdAt:l.a.firestore.FieldValue.serverTimestamp(),shiters:[]}).then((function(t){l.a.firestore().collection("posts").doc(n).update({comments:l.a.firestore.FieldValue.arrayUnion(t.id)})}))}(s,n.uid,e),a("")}})})]})]})},X=n(14),Q=n(7),$=function(t,e,n){var r=Object(c.useState)(!0),o=Object(i.a)(r,2),s=o[0],a=o[1],u=Object(c.useState)([]),d=Object(i.a)(u,2),j=d[0],b=d[1],f=Object(c.useState)([]),O=Object(i.a)(f,2),h=O[0],m=O[1],p=Object(c.useState)([]),x=Object(i.a)(p,2),g=x[0],v=x[1],y=Object(c.useState)([]),w=Object(i.a)(y,2),C=w[0],S=w[1],N=Object(c.useState)(!1),I=Object(i.a)(N,2),k=I[0],E=I[1],A=Object(c.useState)(!0),P=Object(i.a)(A,2),_=P[0],B=P[1],T=Object(c.useState)(!1),F=Object(i.a)(T,2),D=F[0],L=F[1];Object(c.useEffect)((function(){if(s)return l.a.firestore().collection("posts").doc(t).onSnapshot((function(t){if(!t.exists)return a(!1);m((function(e){return t.get("comments")})),e((function(e){return Object(Q.a)(Object(Q.a)({},e),{},{comments:t.get("comments"),shiters:t.get("shiters")})}))}))}),[s]);return Object(c.useEffect)((function(){h.length&&(C.length?h.filter((function(t){return!C.includes(t)})).filter((function(t){return!g.includes(t)})).forEach((function(t){!function(t){v((function(e){return[t].concat(Object(X.a)(e))})),l.a.firestore().collection("comments").doc(t).get().then((function(t){b((function(e){return[].concat(Object(X.a)(e.map((function(t){return{comment:t.comment,is_new:!1}}))),[{comment:Object(Q.a)(Object(Q.a)({},t.data()),{},{commentId:t.id,createdAt:t.get("createdAt").toDate()}),is_new:!0}])}))})).catch((function(t){L(!0)}))}(t)})):(S(h),B(!1),E(!0)))}),[h]),Object(c.useEffect)((function(){k&&(E(!1),C.filter((function(t){return!g.includes(t)})).slice(-10).reverse().forEach((function(t){return function(t){v((function(e){return[].concat(Object(X.a)(e),[t])})),l.a.firestore().collection("comments").doc(t).get().then((function(t){b((function(e){return[{comment:Object(Q.a)(Object(Q.a)({},t.data()),{},{commentId:t.id,createdAt:t.get("createdAt").toDate()}),is_new:!1}].concat(Object(X.a)(e.map((function(t){return{comment:t.comment,is_new:!1}}))))}))})).catch((function(t){L(!0)}))}(t)})))}),[k]),Object(c.useEffect)((function(){h.length===g.length&&B(!0)}),[h,g]),{comments:j,setToggle:E,end:_,error:D}},tt=function(t,e){var n=Object(c.useState)(),r=Object(i.a)(n,2),o=r[0],s=r[1],a=Object(c.useState)(""),u=Object(i.a)(a,2),l=u[0],d=u[1];Object(c.useEffect)((function(){return ft.collection("activities").doc("posts").onSnapshot((function(t){s(t.data())}))}),[]),Object(c.useEffect)((function(){if(o&&t){if(""===l)return d(o.uuid);if(o.uuid!==l)if(d(o.uuid),"add"===o.type){if(t.find((function(t){return t.postId===o.postId})))return;ft.collection("posts").doc(o.postId).get().then((function(t){e((function(e){return[Object(Q.a)(Object(Q.a)({},t.data()),{},{postId:t.id,createdAt:t.get("createdAt").toDate()})].concat(Object(X.a)(e))}))}))}else if("delete"===o.type){if(!t.find((function(t){return t.postId===o.postId})))return;e(t.filter((function(t){return t.postId!==o.postId})))}else if("edit"===o.type){if(!t.find((function(t){return t.postId===o.postId})))return;ft.collection("posts").doc(o.postId).get().then((function(t){e((function(e){return e.map((function(e){return e.postId!==o.postId?e:Object(Q.a)(Object(Q.a)({},t.data()),{},{postId:t.id,createdAt:t.get("createdAt").toDate()})}))}))}))}}}),[o,t,l])},et=function(){var t=Object(c.useContext)(L),e=t.post,n=t.setPost,r=$(e.postId,n),o=r.comments,s=r.setToggle,a=r.end,u=r.error,l=Object(c.useRef)(null),d=Object(c.useState)(!0),j=Object(i.a)(d,2),b=j[0],f=j[1];return u?Object(m.jsx)(E,{content:"error"}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{ref:l,className:"Post Comment-outer",id:"infinite-comment-scroll"+e.postId,onScroll:function(){var t=l.current;t&&t.scrollTop>-60?!1===b&&f(!0):!0===b&&f(!1)},children:o&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(D.a,{dataLength:o.length,next:function(){return s(!0)},hasMore:!a,inverse:!0,scrollableTarget:"infinite-comment-scroll"+e.postId,loader:null,children:o.map((function(t,e){return e===o.length-1?Object(m.jsx)(Z,{cmt:t,commentSectionRef:l,atBottom:b},t.comment.commentId):Object(m.jsx)(Z,{cmt:t,commentSectionRef:l},t.comment.commentId)}))}),Object(m.jsx)("div",{className:"Comment",children:a?null:"loading..."})]})}),Object(m.jsx)("div",{className:"Comment-scroll-to-bottom-outer",children:!b&&Object(m.jsx)("button",{className:"Comment-scroll-to-bottom btn-thin btn-round btn-border",onClick:function(){var t=l.current;t&&t.scrollTo(0,t.scrollHeight)},children:"scroll to bottom"})}),Object(m.jsx)("div",{className:"Post",children:Object(m.jsx)(H,{postId:e.postId})})]})},nt=function(t){var e=t._post,n=t.redirect,r=Object(c.useContext)(ht),o=Object(c.useState)(""),s=Object(i.a)(o,2),a=s[0],u=s[1],l=Object(c.useState)(!1),d=Object(i.a)(l,2),j=d[0],b=d[1],f=Object(c.useState)(!1),O=Object(i.a)(f,2),h=O[0],p=O[1],x=Object(c.useState)((function(){return e})),g=Object(i.a)(x,2),v=g[0],y=g[1];return Object(c.useEffect)((function(){y(e),u(e.content.replaceAll("n_n_","\n"))}),[e]),Object(m.jsx)(L.Provider,{value:{post:v,setPost:y},children:Object(m.jsxs)("div",{className:"Post-outer",style:{width:"100%",margin:"calc(1vh + 15px) 0",borderRadius:"10px"},children:[Object(m.jsxs)("div",{style:{padding:"10px"},children:[Object(m.jsxs)("div",{className:"Post-content-upper",children:[Object(m.jsx)(P,{type:"large",uid:v.author,withName:!0,redirect:!1!==n||void 0,hover:!1!==n||void 0}),Object(m.jsxs)("div",{style:{display:"flex"},children:[r.uid===v.author&&Object(m.jsx)(V,{toggleEdit:h,setToggleEdit:p,editedContent:a}),Object(m.jsx)(K,{postId:v.postId})]})]}),h?Object(m.jsx)(G,{editedContent:a,setEditedContent:u,markdown:v.markdown}):Object(m.jsx)(R,{})]}),v.image&&Object(m.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(m.jsx)("img",{src:v.image,alt:"just an img",style:{maxWidth:"100%",height:"auto"}})}),!v.image.length&&Y(v.content)&&Object(m.jsx)(q,{content:v.content}),Object(m.jsx)("div",{className:"Post-strike"}),Object(m.jsx)(W,{setToggleComments:b}),j&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"Post-strike"}),Object(m.jsx)(et,{})]})]})})},ct=function(t){var e=t.POSTS,n=e.posts,c=e.setPosts,r=e.setToggle,o=e.end,s=e.error;return tt(n,c),s?Object(m.jsx)(E,{content:"error"}):Object(m.jsx)("div",{children:Object(m.jsx)(D.a,{dataLength:n.length,next:function(){return r(!0)},hasMore:!o,loader:Object(m.jsx)(E,{content:"loading"}),endMessage:Object(m.jsx)(E,{content:"you've reached the end of the internet"}),children:n.map((function(t){return Object(m.jsx)(nt,{_post:t},t.postId)}))})})},rt=function(t){var e=t.POSTS;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(F,{}),Object(m.jsx)(ct,{POSTS:e})]})},ot=(n(95),function(t){var e=t.toggle,n=Object(c.useContext)(ht),r=function(){var t=localStorage.getItem("color"),e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return t?"dark"===t?"light":"dark":"dark"===e?"light":"dark"};return Object(m.jsxs)("div",{className:"Menu-DropDown-Items",style:{display:e?"":"none"},children:[window.location.pathname!=="/user/".concat(n.uid)&&Object(m.jsx)("button",{className:"btn-thin btn-sharp btn-top btn-border",children:Object(m.jsx)(a.b,{to:"/user/".concat(n.uid),children:"My posts"})}),Object(m.jsxs)("button",{className:"btn-thin btn-sharp btn-top btn-border",onClick:function(){return t=r(),localStorage.setItem("color",t),void window.location.reload();var t},children:[r()," mode"]}),Object(m.jsx)("button",{className:"btn-thin btn-sharp btn-top btn-border",onClick:function(){return localStorage.clear()},children:"Clear cache"}),Object(m.jsx)("button",{className:"btn-thin btn-sharp btn-top btn-border",onClick:function(){S(n),h()},children:"Logout"})]})}),st=function(){var t=Object(c.useContext)(ht),e=Object(c.useState)(!1),n=Object(i.a)(e,2),r=n[0],o=n[1],s=function(){var t=Object(c.useState)("up"),e=Object(i.a)(t,2),n=e[0],r=e[1];return Object(c.useEffect)((function(){var t=window.pageYOffset,e=!1,n=function(){var n=window.pageYOffset;Math.abs(n-t)<0||(r(n>t?"up":"down"),t=n>0?n:0),e=!1},c=function(){e||(window.requestAnimationFrame(n),e=!0)};return window.addEventListener("scroll",c),function(){return window.removeEventListener("scroll",c)}}),[n]),"down"===n}();return Object(m.jsx)("div",{className:"Nav-outer ".concat(s?"":"Nav-hide"),children:Object(m.jsxs)("div",{className:"Nav-inner",children:[Object(m.jsx)(a.b,{to:"/",children:Object(m.jsx)("h1",{className:"Nav-h1",children:"Shite."})}),Object(m.jsxs)("div",{className:"Menu-DropDown",onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},onFocus:function(){return o(!0)},onBlur:function(){return o(!1)},children:[Object(m.jsx)(P,{type:"large",uid:t.uid,hover:!0}),Object(m.jsx)(ot,{toggle:r})]})]})})},it=function(t,e){var n=Object(c.useState)([]),r=Object(i.a)(n,2),o=r[0],s=r[1],a=Object(c.useState)([]),u=Object(i.a)(a,2),d=u[0],j=u[1],b=Object(c.useState)([]),f=Object(i.a)(b,2),O=f[0],h=f[1],m=Object(c.useState)([]),p=Object(i.a)(m,2),x=p[0],g=p[1],v=Object(c.useState)(!1),y=Object(i.a)(v,2),w=y[0],C=y[1],S=Object(c.useState)(!0),N=Object(i.a)(S,2),I=N[0],k=N[1],E=Object(c.useState)(!1),A=Object(i.a)(E,2),P=A[0],_=A[1];return Object(c.useEffect)((function(){s([]),j([]),h([]),g([]),C(!1),k(!0),_(!1)}),[t]),Object(c.useEffect)((function(){var e=o.map((function(t){return t.postId})).filter((function(t){return!d.includes(t)}));g((function(t){return[].concat(Object(X.a)(e),Object(X.a)(t))})),l.a.firestore().collection("users").doc(t).get().then((function(t){if(!t.exists)return _(!0);j((function(e){return t.get("posts")}))}))}),[o]),Object(c.useEffect)((function(){d.length&&(h(d),o.length||(C(!0),k(!1)))}),[d]),Object(c.useEffect)((function(){if(w){C(!1);var t=O.filter((function(t){return!x.includes(t)})).slice(-4).reverse();g((function(e){return[].concat(Object(X.a)(e),Object(X.a)(t))})),t.forEach((function(t){return function(t){l.a.firestore().collection("posts").doc(t).get().then((function(t){s((function(e){return[].concat(Object(X.a)(e),[Object(Q.a)(Object(Q.a)({},t.data()),{},{postId:t.id,createdAt:t.get("createdAt").toDate()})])}))})).catch((function(t){_(!0)}))}(t)}))}}),[w]),Object(c.useEffect)((function(){o.map((function(t){return t.postId})).length===O.length&&k(!0)}),[o,O]),{posts:o,setPosts:s,setToggle:C,end:I,error:P}},at=(n(60),function(t){var e=t.editedBio,n=t.setEditedBio,r=t.setToggleEditBio,o=Object(c.useContext)(ht);return Object(m.jsxs)("div",{className:"Banner-BioEditor",children:[Object(m.jsx)(k,{content:e,setContent:n,placeholder:"Describe who you are",rows:5,style:{textAlign:"center"}}),Object(m.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[Object(m.jsx)("button",{className:"btn-top btn-thin btn-sharp",onClick:function(){return r(!1)},children:"cancel"}),Object(m.jsx)("button",{className:"btn-top btn-thin btn-sharp btn-left",onClick:function(){var t,n;t=o.uid,n=e,ft.collection("users").doc(t).update({bio:N(n)}).then((function(){window.location.reload()}))},children:"Save"})]})]})}),ut=function(t){var e=t.bio,n=t.isOwner,r=Object(c.useState)(e),o=Object(i.a)(r,2),s=o[0],a=o[1],u=Object(c.useState)(!1),l=Object(i.a)(u,2),d=l[0],j=l[1];return Object(c.useEffect)((function(){a(e.replaceAll("n_n_","\n"))}),[e]),Object(m.jsxs)(m.Fragment,{children:[e&&!d&&Object(m.jsx)("div",{className:"Banner-bio",children:Object(m.jsx)("div",{children:Object(m.jsx)(T,{content:e,center:!0})})}),n&&(d?Object(m.jsx)(at,{editedBio:s,setEditedBio:a,setToggleEditBio:j}):Object(m.jsxs)("div",{className:"Banner-bio-edit",onClick:function(){return j(!0)},children:[Object(m.jsx)("br",{}),e?"Edit Bio":"Add Bio"]}))]})},lt=function(t){var e=t.uid,n=t.isOwner,r=t.cover,o=Object(c.useState)(""),s=Object(i.a)(o,2),a=s[0],u=s[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"Banner-cover-edit".concat(a.length?"-confirm":""),children:n&&Object(m.jsxs)(m.Fragment,{children:[" ",Object(m.jsx)(I,{image_str:a,setImage_str:u,title:"Edit Cover",title_cancel:"Cancel"}),a.length?Object(m.jsx)("button",{className:"btn-thin btn-sharp btn-left",onClick:function(){!function(t,e){ft.collection("users").doc(t).update({cover:e}).then((function(){window.location.reload()}))}(e,a)},children:"Upload"}):void 0]})}),Object(m.jsx)("img",{src:a.length?a:r,alt:"user's cover",className:"Banner-cover"})]})},dt=function(t){var e=t.uid,n=t.isOwner,c=A(e,!0),r=c.name,o=c.avatar,s=c.bio,i=c.cover;return c.error?Object(m.jsx)(E,{content:"error"}):Object(m.jsxs)("div",{className:"Banner",children:[Object(m.jsx)("div",{className:"Banner-upper",children:Object(m.jsx)(lt,{uid:e,isOwner:n,cover:i})}),Object(m.jsxs)("div",{className:"Banner-lower",children:[Object(m.jsx)("img",{src:o,alt:"user's avatar",className:"Banner-avatar"}),Object(m.jsx)("h1",{className:"Banner-name",children:r}),Object(m.jsx)(ut,{bio:s,isOwner:n})]})]})},jt=function(t){var e=t.uid,n=e===Object(c.useContext)(ht).uid,r=it(e),o=r.posts,s=r.setPosts,i=r.setToggle,a=r.end,u=r.error;return tt(o,s),u?Object(m.jsx)(E,{content:"error"}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(dt,{uid:e,isOwner:n}),n&&Object(m.jsx)(F,{}),Object(m.jsx)(D.a,{dataLength:o.length,next:function(){return i(!0)},hasMore:!a,loader:Object(m.jsx)(E,{content:"loading"}),endMessage:null,children:o.map((function(t){return Object(m.jsx)(nt,{_post:t,redirect:!1},t.postId)}))}),o.length?a&&Object(m.jsx)(E,{content:"you've reached the end of the internet"}):null]})},bt=function(t){var e=function(t){var e=Object(c.useState)(),n=Object(i.a)(e,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){t?ft.collection("posts").doc(t).get().then((function(t){o(Object(Q.a)(Object(Q.a)({},t.data()),{},{postId:t.id,createdAt:t.get("createdAt").toDate()}))})):ft.collection("posts").orderBy("createdAt","desc").limit(1).get().then((function(t){t.forEach((function(t){o(Object(Q.a)(Object(Q.a)({},t.data()),{},{postId:t.id,createdAt:t.get("createdAt").toDate()}))}))}))}),[]),r}(t.postId);return e?Object(m.jsx)(nt,{_post:e}):Object(m.jsx)(E,{content:"loading"})};n(225);l.a.apps.length||l.a.initializeApp({apiKey:"AIzaSyBjfz_a3vEm-JLHGZlYXt0AjWZWS1aYq7s",authDomain:"tester02-b908a.firebaseapp.com",projectId:"tester02-b908a",storageBucket:"tester02-b908a.appspot.com",messagingSenderId:"830501078103",appId:"1:830501078103:web:8de8da0851e0e154f8cf12"});var ft=l.a.firestore(),Ot=l.a.auth(),ht=r.a.createContext({}),mt=function(){var t=Object(d.a)(Ot),e=Object(i.a)(t,3),n=e[0],r=e[1],o=e[2],s=function(t){var e=Object(c.useState)([]),n=Object(i.a)(e,2),r=n[0],o=n[1],s=Object(c.useState)((function(){return!0})),a=Object(i.a)(s,2),u=a[0],d=a[1],j=Object(c.useState)(!1),b=Object(i.a)(j,2),f=b[0],O=b[1],h=Object(c.useState)(!1),m=Object(i.a)(h,2),p=m[0],x=m[1];return Object(c.useEffect)((function(){u&&(d(!1),l.a.firestore().collection("posts").orderBy("createdAt","desc").startAfter(r.length?r[r.length-1].createdAt:"").limit(t||5).get().then((function(t){t.empty&&O(!0),o((function(e){return[].concat(Object(X.a)(e),Object(X.a)(t.docs.map((function(t){return Object(Q.a)(Object(Q.a)({},t.data()),{},{postId:t.id,createdAt:t.get("createdAt").toDate()})}))))}))})).catch((function(t){x(!0)})))}),[u]),{posts:r,setPosts:o,setToggle:d,end:f,error:p}}();return o?Object(m.jsx)(E,{content:"Error"}):r?Object(m.jsx)(E,{content:"Loading"}):n?(S(n),Object(m.jsx)(ht.Provider,{value:n,children:Object(m.jsxs)(a.a,{basename:"/shite",children:[Object(m.jsx)(st,{}),Object(m.jsx)("div",{className:"Container-outer",children:Object(m.jsx)("div",{className:"Container",children:Object(m.jsxs)(u.c,{children:[Object(m.jsx)(u.a,{exact:!0,path:"/",render:function(){return Object(m.jsx)(rt,{POSTS:s})}}),Object(m.jsx)(u.a,{path:"/user/:uid",exact:!0,render:function(t){var e=t.match.params.uid;return Object(m.jsx)(jt,{uid:e})}}),Object(m.jsx)(u.a,{path:"/post/:id",exact:!0,render:function(t){var e=t.match.params.id;return Object(m.jsx)(bt,{postId:e})}}),Object(m.jsx)(u.a,{path:"",render:function(){return Object(m.jsx)(E,{content:"page not found"})}})]})})})]})})):Object(m.jsx)(p,{})};n(226)("./".concat(localStorage.getItem("color")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),".css")),s.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(mt,{})}),document.getElementById("root"))},27:function(t,e,n){},37:function(t,e,n){},38:function(t,e,n){},59:function(t,e,n){},60:function(t,e,n){},95:function(t,e,n){}},[[227,1,2]]]);